# MovieFrameSnap Lite

動画から手動でフレームを抽出し、注釈を追加できるデスクトップアプリケーション

## 機能

### 1. 動画ファイル選択
- ファイル選択ダイアログまたはドラッグ&ドロップで動画を読み込み
- 対応形式: MP4, MOV, AVI, WebM など、一般的な動画形式

### 2. 動画範囲の指定
- スライダーまたは手動入力で開始・終了時刻を設定
- 現在の再生位置から範囲を設定可能
- 選択範囲のみを再生
- 範囲をリセット（全体を選択）

### 3. 画像抽出（手動）
- 現在の再生位置から1枚ずつ画像を抽出
- タイムスタンプの表示/非表示
- 図形アノテーションを含めて抽出
- テキスト注釈を含めて抽出
- 抽出画像はギャラリーに表示され、個別にダウンロード可能

### 4. テキスト注釈
- 特定の時刻にテキスト注釈を追加
- 文字色と背景色をカスタマイズ
- 注釈なし（時刻のみ）の登録も可能
- 注釈をクリックしてその時刻にジャンプ
- 注釈の削除

### 5. 図形アノテーション
- 動画上に図形を描画（四角、丸、矢印、線）
- マウスドラッグで描画
- 図形の色を選択
- 図形の削除

### 6. 動画トリミング
- 選択範囲の動画を切り出してダウンロード
- 音声の含める/含めないを選択
- FFmpegを使用した高品質な処理

## インストール

### 必要要件
- Node.js (v14以上)

### セットアップ手順

1. リポジトリをクローン（または解凍）

```bash
cd MovieFrameSnap-Lite
```

2. 依存パッケージをインストール

```bash
npm install
```

## 起動方法

```bash
npm start
```

アプリケーションウィンドウが開きます。

## 使い方

### 基本的な流れ

1. **動画を読み込む**
   - 「ファイルを選択 / ドロップ」エリアをクリックして動画ファイルを選択
   - または動画ファイルをドラッグ&ドロップ

2. **範囲を指定（オプション）**
   - 必要に応じて、動画の開始・終了時刻を設定
   - 「範囲を再生」ボタンで確認

3. **注釈を追加（オプション）**
   - テキスト注釈: 右側のパネルで入力して「追加」
   - 図形: 図形ボタンを選択して動画上でドラッグ

4. **画像を抽出**
   - 動画を再生して好きな位置で一時停止
   - 「現在位置の画像を抽出」ボタンをクリック
   - 抽出した画像は下のギャラリーに表示されます

5. **画像をダウンロード**
   - ギャラリーの各画像の「保存」ボタンをクリック

6. **動画をトリミング（オプション）**
   - 「トリミング動画をダウンロード」ボタンで範囲指定した動画を保存

### ショートカット

- **スペースキー**: 再生/一時停止
- **左右矢印キー**: コマ送り/戻し
- **Ctrl + クリック**: 図形を描画中の場合、描画を開始

## プロジェクト構成

```
MovieFrameSnap-Lite/
├── main.js                 # Electronメインプロセス
├── package.json            # プロジェクト設定
├── src/
│   ├── index.html          # メインHTML
│   ├── style.css           # スタイルシート
│   ├── preload.js          # Electronプリロードスクリプト
│   └── js/
│       ├── utils.js                    # 共通ユーティリティ関数
│       ├── fileHandler.js              # ファイル選択・読み込み
│       ├── videoPlayer.js              # 動画再生制御
│       ├── rangeSelector.js            # 範囲選択
│       ├── annotationManager.js        # テキスト注釈管理
│       ├── shapeAnnotationManager.js   # 図形アノテーション管理
│       ├── frameExtractor.js           # フレーム抽出
│       ├── videoTrimmer.js             # 動画トリミング
│       └── app.js                      # アプリケーション初期化
└── README.md               # このファイル
```

## 開発者向け情報

### コードの構成

- **モジュール化**: 各機能は独立したJavaScriptファイルに分割
- **クラスベース**: 各モジュールはクラスとして実装
- **グローバルインスタンス**: 各クラスはグローバル変数として1つだけインスタンス化
- **コールバック**: モジュール間の通信はコールバック関数で実現

### 技術スタック

- **Electron**: デスクトップアプリケーションフレームワーク
- **FFmpeg**: 動画処理（fluent-ffmpeg, ffmpeg-static）
- **Canvas API**: 画像処理と図形描画
- **HTML5 Video**: 動画再生

### カスタマイズ

各モジュールは独立しているため、機能の追加や変更が容易です。
例えば、新しい図形タイプを追加する場合は `shapeAnnotationManager.js` の `drawShape` メソッドを編集してください。

## トラブルシューティング

### 動画が再生されない
- 対応していない形式の可能性があります
- 別の形式（MP4など）に変換してお試しください

### トリミングが動作しない
- FFmpegが正しくインストールされていない可能性があります
- `npm install` を再実行してください

### 画像が抽出されない
- 動画が正しく読み込まれているか確認してください
- ブラウザコンソール（開発者ツール）でエラーを確認してください

## ライセンス

このプロジェクトは個人利用および学習目的で自由に使用できます。

## 作者

Created with Claude Code
